{% extends "layout.html" %}

{% block title %}Index{% endblock %}
{% block head %}
    {{ parent() }}
{% endblock %}

{% block content %}
<section class="content">
	<div class="row">
		<div class="col-md-12">
			<div class="box box-primary">
				<div class="box-header with-border"><h1 id="form_title"></h1></div>
				<form action="{{ path_for('form.create.submit') }}" method="post">
					<div id="form-items-container" class="form-items-container edit-mode box-body"></div>
					<div class="box-footer"><button type="button" class="btn btn-primary multi-lang" onclick="serializeItem();">Save</button></div>
				</form>
			</div>
		</div>
	</div>
</section>
<script>
	var fda = {};
	var documentReady = function () {
		XTD.api('/form/def/1', function (data) {
			if (data.result) {
				fda = new XTD.FDA(data.result, false).setItemContainerId('form-items-container');
				fda.renderAll();
			}
		});
	};
	
	function serializeItem() {
		//console.log(fda.serializeValue());
		XTD.api('/form/data/{{id}}', 'POST', fda.serializeValue(), function (data) {
			if (data.result) {
				History.back();
			}
		});
	}
	
	var debug = 0;
	function consolelog(msg) {
		if (debug) {
			console.log(msg);
		}
	}
</script>
{% endblock %}

{% block sidebar %}
		
	
{% endblock %}

{% block scripts %}
{% endblock %}
